 -[ ] change compute purity to accept both hyper and hypo only
 -[ ] make everything parallel
